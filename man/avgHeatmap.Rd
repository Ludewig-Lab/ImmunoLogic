% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/avgHeatmap.R
\name{avgHeatmap}
\alias{avgHeatmap}
\title{Average Expression Heatmap for Seurat Objects}
\usage{
avgHeatmap(
  seurat,
  selGenes = NULL,
  group_by = NULL,
  condition_by = NULL,
  scale_method = "row",
  cluster_rows = FALSE,
  cluster_cols = FALSE,
  cluster_order = NULL,
  gene_order = NULL,
  show_rownames = TRUE,
  show_colnames = TRUE,
  cellwidth = 15,
  cellheight = 10,
  color_palette = NULL,
  annotation_colors = NULL,
  condition_colors = NULL,
  gaps_row = NULL,
  gaps_col = NULL,
  n_variable_genes = 20,
  colVecIdent = NULL,
  colVecCond = NULL,
  ordVec = NULL,
  gapVecR = NULL,
  gapVecC = NULL,
  cc = NULL,
  cr = NULL,
  condCol = NULL,
  ...
)
}
\arguments{
\item{seurat}{A Seurat object.}

\item{selGenes}{Character vector of genes to plot, or a data.frame with a column named \code{gene} or \code{geneID}. Defaults to \code{NULL}.}

\item{group_by}{Metadata column in the Seurat object to group cells by. Defaults to \code{NULL} (uses active identity).}

\item{condition_by}{Optional metadata column for a second grouping variable (e.g., treatment condition). Default is \code{NULL}.}

\item{scale_method}{Scaling method for the heatmap: \code{"row"}, \code{"column"}, or \code{"none"}. Default is \code{"row"}.}

\item{cluster_rows}{Logical, whether to cluster rows. Default is \code{FALSE}.}

\item{cluster_cols}{Logical, whether to cluster columns. Default is \code{FALSE}.}

\item{cluster_order}{Optional character vector to manually set the order of columns (clusters). Overrides \code{cluster_cols = FALSE}.}

\item{gene_order}{Optional character vector to manually set the order of rows (genes). Overrides \code{cluster_rows = FALSE}.}

\item{show_rownames}{Logical, whether to display row names (genes). Default is \code{TRUE}.}

\item{show_colnames}{Logical, whether to display column names (groups). Default is \code{TRUE}.}

\item{cellwidth}{Numeric, width of each cell in the heatmap. Default is \code{15}.}

\item{cellheight}{Numeric, height of each cell in the heatmap. Default is \code{10}.}

\item{color_palette}{Color vector for the heatmap. Default is a blue-white-red gradient.}

\item{annotation_colors}{Named list of colors for annotations. Can contain elements named 'Group' and 'Condition'.
Alternatively, provide a named vector which will be used for the Group annotation.}

\item{condition_colors}{Named vector of colors for condition annotation. Only used if \code{condition_by} is specified.}

\item{gaps_row}{Optional vector specifying rows after which to insert gaps. Default is \code{NULL}.}

\item{gaps_col}{Optional vector specifying columns after which to insert gaps. Default is \code{NULL}.}

\item{n_variable_genes}{Number of top variable genes to use if \code{selGenes} is \code{NULL}. Default is \code{20}.}

\item{...}{Additional arguments passed to \code{\link[pheatmap:pheatmap]{pheatmap::pheatmap()}}.}
}
\value{
A \code{pheatmap} object.
}
\description{
Generates a heatmap of averaged expression values for selected genes across cell groups or identities in a Seurat object.
If no genes are provided, the top variable features will be used.
}
\details{
\itemize{
\item Handles gene names as symbols or ENSEMBL IDs.
\item Automatically removes genes with zero variance across groups.
\item If \code{cluster_rows = FALSE} and \code{gene_order = NULL} (default),
orders genes by cluster of maximum expression to create a "staircase" pattern.
\item If \code{gene_order} is provided, genes are kept in the user-provided order.
\item If \code{cluster_order} is provided, clusters are kept in the user-provided order.
\item Automatically selects color palettes based on group names and number of groups.
\item When \code{condition_by} is specified, creates combined groups (e.g., "Cluster0_ConditionA").
}
}
\examples{
\dontrun{
library(Seurat)
seurat <- YourSeuratObject

# Simple heatmap by cell type (default "staircase" gene order)
avgHeatmap(seurat, selGenes = c("GeneA", "GeneB", "GeneC"), group_by = "celltype")

# Heatmap with manually specified gene order
avgHeatmap(seurat,
           selGenes = c("GeneC", "GeneA", "GeneB"),
           group_by = "celltype",
           gene_order = c("GeneC", "GeneA", "GeneB"))

# Heatmap with manually specified cluster (column) order
avgHeatmap(seurat,
           selGenes = c("GeneA", "GeneB"),
           group_by = "celltype",
           cluster_order = c("Cluster 3", "Cluster 1", "Cluster 2"))
}

}
\author{
Mechthild LÃ¼tge, Roman Stadler
}
