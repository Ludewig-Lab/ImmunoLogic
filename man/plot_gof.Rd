% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mmlt_gof.R
\name{plot_gof}
\alias{plot_gof}
\title{Goodness-of-Fit Diagnostic Plots for MMLT Models}
\usage{
plot_gof(
  new_data,
  mmlt_object,
  plot_layout = c(3, 3),
  exclude_variables = c(),
  status = FALSE,
  M = 2000,
  line_color = "red",
  digits = 3,
  add_names = FALSE
)
}
\arguments{
\item{new_data}{Data frame containing the variables used for goodness-of-fit testing.
Must contain the same variables as used in fitting the MMLT model.}

\item{mmlt_object}{Fitted MMLT model object returned by \code{fit_mmlt_flexible} or \code{mmlt}.}

\item{plot_layout}{Numeric vector of length 2 specifying the plot grid dimensions
(rows, columns). Default is \code{c(3, 3)} for a 3x3 grid.}

\item{exclude_variables}{Character vector of variable names to exclude from the
goodness-of-fit assessment. Default is empty.}

\item{status}{Logical. If \code{TRUE}, prints progress messages during computation.
Default is \code{FALSE}.}

\item{M}{Integer. Number of quasi-random points for multivariate normal probability
calculations. Higher values increase accuracy but computation time. Default is 2000.}

\item{line_color}{Color for the reference diagonal line (theoretical uniform CDF).
Default is \code{"red"}.}

\item{digits}{Integer. Number of decimal places for displayed p-values. Default is 3.}

\item{add_names}{Logical. If \code{TRUE}, adds variable names to plot titles.
Default is \code{FALSE}.}
}
\value{
A list containing:
\item{pvalmin}{Minimum p-value across all tests, adjusted using
the beta distribution.}
\item{pvalprod}{Product of all p-values, adjusted for multiple testing.}
\item{individual_pvals}{Named vector of individual test p-values for each dimension.}
\item{test_types}{Named vector indicating which test was used ("KS" or "CvM") for each dimension.}
\item{transformed_data}{Named list of transformed uniform variates for each dimension.}
}
\description{
Creates diagnostic plots to assess the goodness of fit of a multivariate
maximum likelihood transformation (MMLT) model using Rosenblatt transformations.
Plots empirical cumulative distribution functions (ECDFs) of transformed marginal
and conditional distributions and compares them against the theoretical uniform
distribution.
}
\details{
This function implements goodness-of-fit diagnostics based on Rosenblatt transformations.
For a J-dimensional model, it creates J plots showing:
\itemize{
\item Plot 1: Marginal ECDF of \eqn{F_1(Y_1)}
\item Plot i (2 ≤ i ≤ J): Conditional ECDF of \eqn{F_i(Y_i | Y_1, ..., Y_{i-1})}
}

Under correct model specification, each transformed variate should follow a
uniform distribution on \link{0,1}. Deviations indicate model misspecification.

The function automatically detects ties in the transformed data (which occur with
discrete or ordered variables) and uses the Cramér-von Mises test instead of the
Kolmogorov-Smirnov test when ties are present. For continuous variables without
ties, the standard KS test is used.

Two omnibus tests are reported:
\itemize{
\item \strong{Minimum p-value test}: Tests whether the minimum p-value is
suspiciously small (adjusted via beta distribution)
\item \strong{Product p-value test}: Combines all p-values using Fisher's method
}
}
\note{
\itemize{
\item Requires the \code{tram} package and its dependencies
\item Computation time increases with M and the number of dimensions
\item For high-dimensional models, consider using a larger plot layout
}
}
\examples{
\dontrun{
library(tram)
data <- data.frame(
  x1 = rnorm(200),
  x2 = rnorm(200),
  x3 = rnorm(200)
)

# Fit MMLT model
model <- fit_mmlt_flexible(data, automatic = TRUE)

# Assess goodness of fit
gof_results <- plot_gof(
  new_data = data,
  mmlt_object = model$object,
  plot_layout = c(2, 2),
  add_names = TRUE
)

# Check overall fit
print(gof_results$pvalmin)
print(gof_results$pvalprod)
}
}
\seealso{
\code{\link{fit_mmlt_flexible}}, \code{\link[tram]{mmlt}}
}
\author{
Roman Stadler
}
