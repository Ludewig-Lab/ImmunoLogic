% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/avgHeatmap.R
\name{avgHeatmap}
\alias{avgHeatmap}
\title{Average Expression Heatmap for Seurat Objects}
\usage{
avgHeatmap(
  seurat,
  selGenes = NULL,
  group_by = NULL,
  scale_method = "row",
  cluster_rows = FALSE,
  cluster_cols = FALSE,
  show_rownames = TRUE,
  show_colnames = TRUE,
  cellwidth = 15,
  cellheight = 10,
  color_palette = NULL,
  annotation_colors = NULL,
  gaps_row = NULL,
  gaps_col = NULL,
  n_variable_genes = 20,
  colVecIdent = NULL,
  colVecCond = NULL,
  ordVec = NULL,
  gapVecR = NULL,
  gapVecC = NULL,
  cc = NULL,
  cr = NULL,
  condCol = NULL,
  ...
)
}
\arguments{
\item{seurat}{A Seurat object.}

\item{selGenes}{Character vector of genes to plot, or a data.frame with a column named \code{gene} or \code{geneID}. Defaults to \code{NULL}.}

\item{group_by}{Metadata column in the Seurat object to group cells by. Defaults to \code{NULL} (uses active identity).}

\item{scale_method}{Scaling method for the heatmap: \code{"row"}, \code{"column"}, or \code{"none"}. Default is \code{"row"}.}

\item{cluster_rows}{Logical, whether to cluster rows. Default is \code{FALSE}.}

\item{cluster_cols}{Logical, whether to cluster columns. Default is \code{FALSE}.}

\item{show_rownames}{Logical, whether to display row names (genes). Default is \code{TRUE}.}

\item{show_colnames}{Logical, whether to display column names (groups). Default is \code{TRUE}.}

\item{cellwidth}{Numeric, width of each cell in the heatmap. Default is \code{15}.}

\item{cellheight}{Numeric, height of each cell in the heatmap. Default is \code{10}.}

\item{color_palette}{Color vector for the heatmap. Default is a blue-white-red gradient.}

\item{annotation_colors}{Named list or named vector of colors for annotations.
If a named vector is provided, it will be automatically wrapped as \code{list(Group = your_vector)}.
The vector should be named with group levels, or have length matching the number of groups.}

\item{gaps_row}{Optional vector specifying rows after which to insert gaps. Default is \code{NULL}.}

\item{gaps_col}{Optional vector specifying columns after which to insert gaps. Default is \code{NULL}.}

\item{n_variable_genes}{Number of top variable genes to use if \code{selGenes} is \code{NULL}. Default is \code{20}.}

\item{...}{Additional arguments passed to \code{\link[pheatmap:pheatmap]{pheatmap::pheatmap()}}.}
}
\value{
A \code{pheatmap} object.
}
\description{
Generates a heatmap of averaged expression values for selected genes across cell groups or identities in a Seurat object.
If no genes are provided, the top variable features will be used.
}
\details{
\itemize{
\item Handles gene names as symbols or ENSEMBL IDs.
\item Automatically removes genes with zero variance across groups.
\item Orders genes by cluster of maximum expression if \code{cluster_rows = FALSE}.
\item Automatically selects color palettes based on group names and number of groups.
}
}
\examples{
\dontrun{
library(Seurat)
seurat <- YourSeuratObject

# Using default colors
avgHeatmap(seurat, selGenes = c("GeneA", "GeneB"), group_by = "celltype")

# Using custom colors (named vector)
my_colors <- c("Cluster0" = "#FF0000", "Cluster1" = "#00FF00")
avgHeatmap(seurat, selGenes = c("GeneA", "GeneB"), annotation_colors = my_colors)

# Using custom colors (unnamed vector - will be matched to groups in order)
my_colors <- c("#FF0000", "#00FF00", "#0000FF")
avgHeatmap(seurat, selGenes = c("GeneA", "GeneB"), annotation_colors = my_colors)
}

}
\author{
Mechthild LÃ¼tge, Roman Stadler
}
